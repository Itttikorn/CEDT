SELECT T.NAME,
	AVG(F.HP + F.ATTACK + F.DEFENSE) AS AVGSTATS,
	COUNT(*) AS FRIENDNUM
FROM TRAINER T
JOIN FRIEND F ON F.TRAINERID = T.ID
GROUP BY T.ID
ORDER BY AVGSTATS DESC